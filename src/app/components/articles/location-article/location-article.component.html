<div class="main">
    <article *ngIf="location; else loading">
        <!-- Heading -->
        <app-edit-toggle [isInUpdateState]=false [link]="'update'"></app-edit-toggle>
        <a routerLink="/marker/{{location.parent_location_details.name}}/{{location.name}}/create" class="btn btn-outline-secondary float-right mr-4">
            Add Marker
        </a>

        <h1 class="text-center">
            {{ location.name }} 
            <a *ngFor="let marker of location.marker_details" class="mx-1 no-underline" routerLink="{{constants.wikiUrlFrontendPrefix}}/marker/{{location.parent_location_details.name}}/{{location.name}}/{{marker.map}}">
                <i class="fa fa-{{marker.map_icon}} icon"></i>
            </a>
        </h1>
        <!-- String indicating all parent_locations -->
        <p *ngIf="location.parent_location_list.length > 0" class="text-center font-italic mb-5">
            <span *ngFor="let loc of location.parent_location_list; let i = index"> 
                <a routerLink="{{buildLocationRoute(i)}}">
                    {{loc}}
                </a>
                <i class="fa fa-arrow-right mx-1"></i>
            </span>
            {{location.name}}
        </p>

        <!-- Image Gallery -->
        <app-image-gallery
        [article_type]="this.articleType"
        [article_pk]="this.location.pk"
        [images]="this.location.images"
        ></app-image-gallery>

        <!-- Description -->
        <div class="mb-5">
            <app-textfield 
            [initialText]="location.description"
            [heading]="'Description'"
            (updateText)="onDescriptionUpdate($event)"
            ></app-textfield>
        </div>

        <!-- Characters of Interest -->

        <div class="mb-4">
            <app-object-list    [heading]="'Characters of Interest'"
                                [items]="location.characters"
                                [articleType]="'character'"
                                [createLink]="'/character/create'"></app-object-list>
        </div>

        <!-- Locations of Interest -->
        <h4>Locations of Interest <i class="fa fa-plus icon ml-1" routerLink="create"></i></h4>
        <div class="encounter-list mb-5 mt-3">
            <app-location-accordion [sublocations]="location.sublocations"></app-location-accordion>
        </div>

        <!-- Delete Button -->
        <app-delete-toggle [deleteMessage]="'Delete '+location.name+'?'" (deleteEvent)="deleteArticle()"></app-delete-toggle>


        <!-- Return Buttons -->
        <a routerLink="{{constants.wikiUrlFrontendPrefix}}/location" class="btn btn-outline-secondary mr-1">Back to locations</a>
        <a 
        *ngIf="location.parent_location_details.name !== constants.NONE_STRING"
        routerLink="{{constants.wikiUrlFrontendPrefix}}/location/{{location.parent_location_details.parent_location}}/{{location.parent_location_details.name}}"
        class="btn btn-secondary">
            Back to {{location.parent_location_details.name}}
        </a>
    </article>
    <ng-template #loading class="mb-4"> <app-spinner></app-spinner> </ng-template> 
</div>

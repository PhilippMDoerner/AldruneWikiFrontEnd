<div class="card row mb-3 px-4 pt-3 pb-1">
    <!-- Rules Panel Heading -->
    <h5 class="pointer col-12 justify-content-between d-flex align-items-center" (click)="togglePanel()"> 
        <span>{{ rule.name }}</span>
        <i [ngClass]="{'fa icon float-right': true, 'fa-chevron-down': !isOpen, 'fa-chevron-up': isOpen}"></i>
    </h5>


    <!-- Separator + Edit Toggler -->
    <div class="col-12" *ngIf="isOpen">
        <hr class="white-separator mb-2">

        <!-- Edit Toggler -->
        <div class="btn btn-secondary float-right" (click)="toggleFormState()">
            <i class="fa fa-pencil" *ngIf="!isCreateState && !isUpdateState"></i>
            <i class="fa fa-times" *ngIf="isCreateState || isUpdateState"></i>
        </div>
    </div>

    <!-- Rules Panel Content -->
    <div class="col-12" [ngbCollapse]="!isOpen">
        <div [innerHTML]="rule.description" *ngIf="!isUpdateState && !isCreateState; else formField"></div>

        <div class="mb-3">
            <app-delete-toggle
            [deleteMessage] = "'Delete this rule ?'"
            (deleteEvent) = "onDelete()"
            ></app-delete-toggle> 
        </div>

    </div>
</div>

<ng-template #formField>
    <div id="edit-section">
        <!-- Form -->
        <app-formly-formcontainer 
        [model]="rule" 
        [fields]="fields" 
        (submit)="onSubmit()" 
        (cancel)="onCancel()"
        ></app-formly-formcontainer>
    </div>
</ng-template>